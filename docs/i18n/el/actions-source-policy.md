# Πολιτική Προέλευσης Ενεργειών (Φάση 1)

Αυτό το έγγραφο ορίζει την τρέχουσα πολιτική ελέγχου προέλευσης των GitHub Actions για αυτό το αποθετήριο.

Στόχος Φάσης 1: Περιορισμός των πηγών των ενεργειών με ελάχιστη αναστάτωση, πριν από την πλήρη εφαρμογή του SHA pinning.

## Τρέχουσα Πολιτική

- Δικαιώματα Actions αποθετηρίου: Ενεργοποιημένα (enabled)
- Λειτουργία επιτρεπόμενων ενεργειών: Επιλεγμένες (selected)
- Απαίτηση SHA pinning: Ψευδές (false - μετατίθεται για τη Φάση 2)

Επιλεγμένα πρότυπα λίστας επιτρεπόμενων (allowlist patterns):

- actions/* (καλύπτει τα actions/cache, actions/checkout, actions/upload-artifact, actions/download-artifact και άλλες επίσημες ενέργειες πρώτου μέρους)
- docker/*
- dtolnay/rust-toolchain@*
- DavidAnson/markdownlint-cli2-action@*
- lycheeverse/lychee-action@*
- EmbarkStudios/cargo-deny-action@*
- rustsec/audit-check@*
- rhysd/actionlint@*
- softprops/action-gh-release@*
- sigstore/cosign-installer@*
- Checkmarx/vorpal-reviewdog-github-action@*
- useblacksmith/* (Υποδομή self-hosted runner της Blacksmith)

## Εξαγωγή Ελέγχου Αλλαγών

Χρησιμοποιήστε αυτές τις εντολές για να εξαγάγετε την τρέχουσα ισχύουσα πολιτική για έλεγχο/διαχείριση αλλαγών:

gh api repos/zeroclaw-labs/zeroclaw/actions/permissions
gh api repos/zeroclaw-labs/zeroclaw/actions/permissions/selected-actions

Καταγράφετε κάθε αλλαγή πολιτικής με:

- Ημερομηνία/ώρα αλλαγής (UTC)
- Υπεύθυνος (actor)
- Αιτιολογία
- Μεταβολή λίστας επιτρεπόμενων (πρότυπα που προστέθηκαν/αφαιρέθηκαν)
- Σημείωση επαναφοράς (rollback note)

## Γιατί αυτή η Φάση

- Μειώνει τον κίνδυνο στην εφοδιαστική αλυσίδα (supply-chain risk) από μη ελεγμένες ενέργειες του marketplace.
- Διατηρεί την τρέχουσα λειτουργικότητα CI/CD με χαμηλό κόστος μετάβασης (migration overhead).
- Προετοιμάζει το έδαφος για την πλήρη εφαρμογή SHA pinning στη Φάση 2, χωρίς να εμποδίζει την ενεργή ανάπτυξη.

## Δικλείδες Ασφαλείας Ροής Εργασιών Πρακτόρων (Agentic Workflow Guardrails)

Επειδή αυτό το αποθετήριο έχει υψηλό όγκο αλλαγών που συντάσσονται από πράκτορες (agents):

- Κάθε PR που προσθέτει ή αλλάζει πηγές ενεργειών (uses:) πρέπει να περιλαμβάνει σημείωμα επίδρασης στη λίστα επιτρεπόμενων.
- Νέες ενέργειες τρίτων απαιτούν ρητή αναθεώρηση από συντηρητή (maintainer) πριν προστεθούν στη λίστα.
- Επεκτείνετε τη λίστα επιτρεπόμενων μόνο για επαληθευμένες ενέργειες που λείπουν· αποφεύγετε τις ευρείες εξαιρέσεις με μπαλαντέρ (wildcards).
- Διατηρείτε οδηγίες επαναφοράς στην περιγραφή του PR για αλλαγές στην πολιτική των Actions.

## Λίστα Ελέγχου Επικύρωσης (Validation Checklist)

Μετά από αλλαγές στη λίστα επιτρεπόμενων, επικυρώστε τα εξής:

1. CI
2. Docker
3. Security Audit (Έλεγχος Ασφαλείας)
4. Workflow Sanity (Ορθότητα Ροής Εργασιών)
5. Release (Έκδοση - όταν είναι ασφαλές να εκτελεστεί)

Κατάσταση σφάλματος προς παρακολούθηση:

- action is not allowed by policy

Εάν παρουσιαστεί, προσθέστε μόνο τη συγκεκριμένη αξιόπιστη ενέργεια που λείπει, εκτελέστε ξανά και τεκμηριώστε τον λόγο.

Πρόσφατες σημειώσεις ελέγχου (Latest sweep notes):

- 2026-02-21: Προσθήκη χειροκίνητης ροής εργασιών Vorpal reviewdog για στοχευμένους ελέγχους ασφαλούς κώδικα σε υποστηριζόμενους τύπους αρχείων.
    - Προσθήκη προτύπου λίστας επιτρεπόμενων: Checkmarx/vorpal-reviewdog-github-action@*
    - Η ροή εργασιών χρησιμοποιεί καρφιτσωμένη πηγή (pinned source): Checkmarx/vorpal-reviewdog-github-action@8cc292f337a2f1dea581b4f4bd73852e7becb50d (v1.2.0)
- 2026-02-17: Η προσωρινή μνήμη εξαρτήσεων (dependency cache) της Rust μεταφέρθηκε από το Swatinem/rust-cache στο useblacksmith/rust-cache.
- 2026-02-16: Ανακάλυψη κρυφής εξάρτησης στο release.yml: sigstore/cosign-installer@...
- 2026-02-16: Η μετάβαση στο Blacksmith εμπόδισε την εκτέλεση των workflows.
    - Προσθήκη προτύπου: useblacksmith/* για την υποδομή self-hosted runner.
- 2026-02-17: Ενημέρωση ισορροπίας μεταξύ αναπαραγωγιμότητας και "φρεσκάδας" του ελέγχου ασφαλείας.
    - Προσθήκη προτύπου: rustsec/audit-check@*
    - Αντικατάσταση της εντολής cargo install cargo-audit με την καρφιτσωμένη ενέργεια rustsec/audit-check@69366f33c96575abad1ee0dba8212993eecbe998 στο security.yml.

## Επαναφορά (Rollback)

Διαδρομή έκτακτης απεμπλοκής:

1. Ορίστε προσωρινά την πολιτική των Actions σε all.
2. Επαναφέρετε την επιλεγμένη λίστα επιτρεπόμενων αφού προσδιορίσετε τις εγγραφές που λείπουν.
3. Καταγράψτε το περιστατικό και την τελική μεταβολή της λίστας επιτρεπόμενων.